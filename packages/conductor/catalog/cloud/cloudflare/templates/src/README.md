# Conductor Template - Entry Points

This template provides multiple entry point options. Choose the approach that best fits your needs.

## Option 1: Auto-Discovery (Recommended) ⭐

**File:** `index-auto-discovery.ts`

The simplest approach - agents and ensembles are automatically discovered from your project directory.

```typescript
import { createAutoDiscoveryAPI } from '@ensemble-edge/conductor/api';
import { agents } from 'virtual:conductor-agents';
import { ensembles } from 'virtual:conductor-ensembles';

export default createAutoDiscoveryAPI({
  autoDiscover: true,
  agents,
  ensembles,
  auth: { allowAnonymous: true },
  logging: true,
});
```

**Use this when:**
- ✅ You want zero-config auto-discovery
- ✅ You're building a standard API
- ✅ You want the fastest setup

**Provides:**
- `POST /api/v1/execute` - Execute agents and ensembles
- `GET /api/v1/agents` - List all agents
- `GET /health` - Health check
- Auto-discovered agents from `agents/**/*.yaml`
- Auto-discovered ensembles from `ensembles/**/*.yaml`

---

## Option 2: Custom Entry Point (Full Control)

**File:** `index.ts` (current default)

Full control over routing, initialization, and endpoints.

```typescript
import { Executor, MemberLoader, PageRouter, UnifiedRouter } from '@ensemble-edge/conductor';

export default {
  async fetch(request, env, ctx) {
    // Your custom logic here
    // Full control over routing, auth, and execution
  }
};
```

**Use this when:**
- ✅ You need custom endpoints
- ✅ You want fine-grained control
- ✅ You're mixing multiple approaches (API + pages + custom logic)

---

## Switching Between Entry Points

To use the auto-discovery approach:

1. **Rename files:**
   ```bash
   mv src/index.ts src/index-custom.ts
   mv src/index-auto-discovery.ts src/index.ts
   ```

2. **Update `vite.config.ts` if needed:**
   ```typescript
   lib: {
     entry: 'src/index.ts',  // Uses the renamed file
   }
   ```

3. **Rebuild:**
   ```bash
   pnpm run build
   ```

---

## Virtual Modules

Both approaches use Vite plugins for auto-discovery:

```typescript
// Auto-discovered at build time
import { pages } from 'virtual:conductor-pages';       // pages/**/*.yaml
import { docs } from 'virtual:conductor-docs';         // docs/**/*.md
import { agents } from 'virtual:conductor-agents';     // agents/**/*.yaml
import { ensembles } from 'virtual:conductor-ensembles'; // ensembles/**/*.yaml
```

These are generated by Vite plugins defined in `vite.config.ts`.

---

## Next Steps

1. **Add agents** to `agents/` directory
2. **Add ensembles** to `ensembles/` directory
3. **Add pages** to `pages/` directory (optional)
4. **Add docs** to `docs/` directory (optional)
5. **Run:** `pnpm run build && npx wrangler dev`

See the documentation for more details: https://conductor.dev/docs
