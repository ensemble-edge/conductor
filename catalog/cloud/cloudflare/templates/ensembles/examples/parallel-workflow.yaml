name: parallel-workflow
description: |
  Example of advanced graph-based workflow with parallel execution,
  branching, and complex dependencies.

  Demonstrates Conductor's sophisticated workflow capabilities.

flow:
  # Step 1: Analyze input
  - member: analyze
    input:
      data: ${input.data}

  # Step 2: Parallel execution - process multiple tasks simultaneously
  - type: parallel
    steps:
      - member: validate
        input:
          data: ${analyze.output.cleaned}

      - member: enrich
        input:
          data: ${analyze.output.cleaned}

      - member: categorize
        input:
          data: ${analyze.output.cleaned}

  # Step 3: Conditional branch based on validation result
  - type: branch
    condition: validate.output.isValid === true
    then:
      # Valid path: Continue processing
      - member: process
        input:
          data: ${enrich.output.enriched}
          category: ${categorize.output.category}
        depends_on: [validate, enrich, categorize]

      # Parallel notifications
      - type: parallel
        steps:
          - member: notify-success
            input:
              result: ${process.output}

          - member: log-success
            input:
              result: ${process.output}

    else:
      # Invalid path: Handle error
      - member: notify-error
        input:
          errors: ${validate.output.errors}

      - member: log-error
        input:
          errors: ${validate.output.errors}

  # Step 4: Loop over results (if processing succeeded)
  - type: foreach
    items: ${process.output.items}
    maxConcurrency: 3
    step:
      member: post-process
      input:
        item: ${item}

output:
  success: ${process.output.success}
  results: ${post-process.output}
  metadata:
    analyzed: ${analyze.output.metadata}
    validated: ${validate.output.isValid}
    category: ${categorize.output.category}
