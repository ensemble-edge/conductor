name = "my-conductor-project"
main = "dist/index.mjs"
compatibility_date = "2025-10-29"
compatibility_flags = ["nodejs_compat"]

# Build configuration for Vite
[build]
command = "npm run build"
watch_dirs = ["src", "pages", "members", "ensembles"]

# Module rules for file imports (kept for backward compatibility)
[[rules]]
type = "Text"
globs = ["**/*.yaml", "**/*.yml"]
fallthrough = true

# ==================== Local Development Secrets ====================
# For local development, copy .dev.vars.example to .dev.vars and add your secrets:
#   cp .dev.vars.example .dev.vars
#
# For production, use wrangler secrets (NOT environment variables):
#   wrangler secret put ANTHROPIC_API_KEY
#   wrangler secret put OPENAI_API_KEY
#
# Learn more: https://developers.cloudflare.com/workers/configuration/secrets/

# ==================== Durable Objects ====================
# Required for stateful workflows, async execution tracking, and HITL
# Uncomment when you need stateful workflows:
# [[durable_objects.bindings]]
# name = "EXECUTION_STATE"
# class_name = "ExecutionState"
# script_name = "my-conductor-project"
#
# [[durable_objects.bindings]]
# name = "HITL_STATE"
# class_name = "HITLState"
# script_name = "my-conductor-project"
#
# [[migrations]]
# tag = "v1"
# new_classes = ["ExecutionState", "HITLState"]

# ==================== Cloudflare Bindings ====================
# Comment out bindings you don't need. All are optional except for Durable Objects above.

# R2 for static assets (images, fonts, global CSS)
# Uncomment when you set up an R2 bucket:
# [[r2_buckets]]
# binding = "ASSETS"
# bucket_name = "conductor-assets"
# preview_bucket_name = "conductor-assets-preview"

# KV for caching and fast lookups
# Uncomment when you create KV namespaces:
# [[kv_namespaces]]
# binding = "CACHE"
# id = "your-kv-namespace-id"
# preview_id = "your-preview-kv-id"

# D1 database for long-term memory
# Uncomment when you create a D1 database:
# [[d1_databases]]
# binding = "DB"
# database_name = "conductor-db"
# database_id = "your-d1-database-id"

# Vectorize for semantic memory (RAG)
# Uncomment when you create a Vectorize index:
# [[vectorize]]
# binding = "VECTORIZE"
# index_name = "conductor-embeddings"

# Email sending via Cloudflare Email Routing
# Uncomment when using Cloudflare email provider:
# [[send_email]]
# name = "EMAIL"
# destination_address_list = "allowed-recipients"

# SMS configuration (via secrets - use wrangler secret put)
# Required secrets for Twilio:
#   wrangler secret put TWILIO_ACCOUNT_SID
#   wrangler secret put TWILIO_AUTH_TOKEN
#   wrangler secret put TWILIO_PHONE_NUMBER

# Hyperdrive bindings for external databases
# Uncomment and configure when connecting to external databases:
# [[hyperdrive]]
# binding = "PRODUCTION_DB"
# id = "your-hyperdrive-id-production"
#
# [[hyperdrive]]
# binding = "ANALYTICS_DB"
# id = "your-hyperdrive-id-analytics"

# AI binding for Think members
# Uncomment when you use Think-type members:
# [ai]
# binding = "AI"

# ==================== Environment Variables ====================
[vars]
ENVIRONMENT = "development"
# Optional: API key authentication (comma-separated)
# API_KEYS = "key1,key2,key3"
# ALLOW_ANONYMOUS = "false"
# DISABLE_LOGGING = "false"

# ==================== Scheduled Triggers (Cron) ====================
# Add cron expressions from your ensemble schedules here
# To get all cron expressions: GET /api/v1/schedules/crons/list
[triggers]
crons = [
  # Example schedules (configure based on your ensembles)
  # "0 9 * * *",      # Daily at 9 AM UTC
  # "0 */4 * * *",    # Every 4 hours
  # "*/15 * * * *"    # Every 15 minutes
]
